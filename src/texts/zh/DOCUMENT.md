`MtFmt`是由纯 C 语言编写而成的格式化库，实现了 PEP-3101 的一个方言，且为嵌入式系统进行了设计优化。

[toc]

# 1 介绍

MtFmt 是一个性能良好且拥有极小体积的 C 语言格式化库，其使用纯 C 实现了 [PEP-3101](https://peps.python.org/pep-3101/) 的一个方言。其包括定点数、数组、日期和时间格式化，且不需要任何除法操作。除此之外，库实现还包括一个可提供 Unicode 支持的字符串对象，以及一个用于实时系统，拥有内存碎片收集功能的堆管理器。其主要特性包括：

* 二、八、十、十六进制表示的整数格式化
* 定点数格式化，如 `q12_t`，可直接格式化为原始的标幺值
* 日期和时间格式化，可用于格式化 RTC 的数据
* 字符串格式化
* 字符格式化
* C 风格的数组格式化
* 可指定格式化的值的符号显示方式、对齐、填充的字符、数组的分隔符、日期时间的格式以及其分隔符
* 可选的带内存碎片回收的分配器，其要求提供一个全局的数组作为堆，并在此基础上实现堆管理
* 支持 UTF-8 字符
* 提供足够多的字符串操作：字符串模式匹配、剔除掉特定字符、进行多个字符串的替换等
* 库实现可以不依赖除法器，在 STM32G0 等单片机上可避免存在额外的软件除法
* 基于返回值的错误处理，C++ 版的错误报告不依赖异常

库的所有实现要求至少支持 ISO C99 的编译器，其 C++ 版要求至少支持 ISO C11 的编译器。

# 2 API 接口

库提供的 API 包括三个部份：字符串操作函数、格式化函数和堆管理器函数。字符串操作部份包括创建或者销毁一个字符串对象、插入或者删除一个字符、查找、模式匹配、替换等多个功能；格式化部份提供格式化的实现，包括一个解析器的前端和一个格式化的后端；堆管理部份是可选的，其提供堆分配和释放。

## 2.1 错误处理

TODO
